Sub DisplayDataInMsgBox()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim msg As String
    Dim startTimeFormat As String
    Dim endTimeFormat As String
    
    ' Set the worksheet
    On Error Resume Next
    Set ws = ThisWorkbook.Sheets("Sheet1") ' Change "Sheet1" to your sheet name
    On Error GoTo 0
    
    ' Check if the worksheet is set
    If ws Is Nothing Then
        MsgBox "Worksheet not found. Please check the sheet name.", vbCritical
        Exit Sub
    End If
    
    ' Determine the last row with data in any of the specified columns
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    lastRow = Application.WorksheetFunction.Max(lastRow, ws.Cells(ws.Rows.Count, "B").End(xlUp).Row)
    lastRow = Application.WorksheetFunction.Max(lastRow, ws.Cells(ws.Rows.Count, "C").End(xlUp).Row)
    lastRow = Application.WorksheetFunction.Max(lastRow, ws.Cells(ws.Rows.Count, "D").End(xlUp).Row)
    lastRow = Application.WorksheetFunction.Max(lastRow, ws.Cells(ws.Rows.Count, "E").End(xlUp).Row)
    lastRow = Application.WorksheetFunction.Max(lastRow, ws.Cells(ws.Rows.Count, "F").End(xlUp).Row)
    
    ' Loop through each row and build the message
    For i = 2 To lastRow ' Assuming the first row contains headers
        ' Build the message only if at least one of the essential columns is not empty
        If Application.WorksheetFunction.CountA(ws.Rows(i)) > 0 Then
            ' Determine the time format based on the cell's number format
            If InStr(1, ws.Cells(i, 2).NumberFormat, "AM/PM", vbTextCompare) > 0 Then
                startTimeFormat = "h:mm AM/PM"
            Else
                startTimeFormat = "HH:mm"
            End If
            
            If InStr(1, ws.Cells(i, 3).NumberFormat, "AM/PM", vbTextCompare) > 0 Then
                endTimeFormat = "h:mm AM/PM"
            Else
                endTimeFormat = "HH:mm"
            End If
            
            msg = "Date: " & ws.Cells(i, 1).Text & vbCrLf & _
                  "Start Time: " & Format(ws.Cells(i, 2).Value, startTimeFormat) & vbCrLf & _
                  "End Time: " & Format(ws.Cells(i, 3).Value, endTimeFormat) & vbCrLf & _
                  "Subject: " & ws.Cells(i, 4).Value & vbCrLf & _
                  "Required Members: " & ws.Cells(i, 5).Value & vbCrLf & _
                  "Optional Members: " & ws.Cells(i, 6).Value
            
            ' Display the message box
            MsgBox msg, vbInformation, "Event Details"
        End If
    Next i
End Sub