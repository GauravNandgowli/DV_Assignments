Sub ScheduleMeetingsInOutlook()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim olApp As Object
    Dim olAppt As Object
    Dim startDate As Date
    Dim endDate As Date
    
    ' Set the worksheet
    On Error Resume Next
    Set ws = ThisWorkbook.Sheets("Sheet1") ' Change "Sheet1" to your sheet name
    On Error GoTo 0
    
    ' Check if the worksheet is set
    If ws Is Nothing Then
        MsgBox "Worksheet not found. Please check the sheet name.", vbCritical
        Exit Sub
    End If
    
    ' Determine the last row with data in any of the specified columns
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    lastRow = Application.WorksheetFunction.Max(lastRow, ws.Cells(ws.Rows.Count, "B").End(xlUp).Row)
    lastRow = Application.WorksheetFunction.Max(lastRow, ws.Cells(ws.Rows.Count, "C").End(xlUp).Row)
    lastRow = Application.WorksheetFunction.Max(lastRow, ws.Cells(ws.Rows.Count, "D").End(xlUp).Row)
    lastRow = Application.WorksheetFunction.Max(lastRow, ws.Cells(ws.Rows.Count, "E").End(xlUp).Row)
    lastRow = Application.WorksheetFunction.Max(lastRow, ws.Cells(ws.Rows.Count, "F").End(xlUp).Row)
    
    ' Initialize Outlook application
    On Error Resume Next
    Set olApp = GetObject(, "Outlook.Application")
    If olApp Is Nothing Then
        Set olApp = CreateObject("Outlook.Application")
    End If
    On Error GoTo 0
    
    ' Loop through each row and create an Outlook meeting
    For i = 2 To lastRow ' Assuming the first row contains headers
        ' Check if at least one of the essential columns is not empty
        If Application.WorksheetFunction.CountA(ws.Rows(i).Columns("A:F")) > 0 Then
            ' Validate and combine date and time for start and end
            If IsDate(ws.Cells(i, 1).Value) And IsDate(ws.Cells(i, 2).Value) Then
                startDate = CDate(ws.Cells(i, 1).Value) + TimeValue(ws.Cells(i, 2).Value)
            Else
                MsgBox "Invalid date or start time in row " & i, vbExclamation
                GoTo NextIteration
            End If
            
            If IsDate(ws.Cells(i, 1).Value) And IsDate(ws.Cells(i, 3).Value) Then
                endDate = CDate(ws.Cells(i, 1).Value) + TimeValue(ws.Cells(i, 3).Value)
            Else
                MsgBox "Invalid end time in row " & i, vbExclamation
                GoTo NextIteration
            End If
            
            ' Create a new appointment item
            Set olAppt = olApp.CreateItem(1) ' 1 = olAppointmentItem
            
            ' Set the appointment details
            With olAppt
                .Start = startDate
                .End = endDate
                .Subject = ws.Cells(i, 4).Value
                .RequiredAttendees = ws.Cells(i, 5).Value
                .OptionalAttendees = ws.Cells(i, 6).Value
                .Body = "Please find the meeting details."
                .ReminderMinutesBeforeStart = 15
                .ReminderSet = True
                .Display ' Display the meeting to allow manual sending
            End With
        End If
NextIteration:
    Next i
End Sub