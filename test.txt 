Sub ScheduleMeetingsInOutlook()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim olApp As Object
    Dim olAppt As Object
    
    ' Set the worksheet
    On Error Resume Next
    Set ws = ThisWorkbook.Sheets("Sheet1") ' Change "Sheet1" to your sheet name
    On Error GoTo 0
    
    ' Check if the worksheet is set
    If ws Is Nothing Then
        MsgBox "Worksheet not found. Please check the sheet name.", vbCritical
        Exit Sub
    End If
    
    ' Determine the last row with data
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Initialize Outlook application
    On Error Resume Next
    Set olApp = GetObject(Class:="Outlook.Application")
    If olApp Is Nothing Then
        Set olApp = CreateObject("Outlook.Application")
    End If
    If olApp Is Nothing Then
        MsgBox "Unable to start Outlook. Please ensure Outlook is installed.", vbCritical
        Exit Sub
    End If
    On Error GoTo 0
    
    ' Loop through each row and create meetings
    For i = 2 To lastRow ' Assuming the first row contains headers
        ' Validate essential columns
        If Not IsEmpty(ws.Cells(i, 1)) And Not IsEmpty(ws.Cells(i, 2)) And Not IsEmpty(ws.Cells(i, 3)) Then
            ' Create a new appointment item
            Set olAppt = olApp.CreateItem(1) ' 1 = olAppointmentItem
            
            ' Error handling for date and time conversion
            On Error Resume Next
            With olAppt
                ' Set meeting date and times
                .Start = CDate(ws.Cells(i, 1).Value) + TimeValue(ws.Cells(i, 2).Value)
                .End = CDate(ws.Cells(i, 1).Value) + TimeValue(ws.Cells(i, 3).Value)
                
                ' Set other meeting details
                .Subject = CStr(ws.Cells(i, 4).Value)
                .RequiredAttendees = CStr(ws.Cells(i, 5).Value)
                .OptionalAttendees = CStr(ws.Cells(i, 6).Value)
                .Body = "Please find the meeting details."
                .ReminderMinutesBeforeStart = 15
                .ReminderSet = True
                
                ' Display the meeting for review
                .Display
            End With
            
            ' Check for any errors during appointment creation
            If Err.Number <> 0 Then
                MsgBox "Error creating meeting in row " & i & ": " & Err.Description, vbExclamation
                Err.Clear
            End If
            On Error GoTo 0
        End If
    Next i
    
    ' Clean up
    Set olAppt = Nothing
    Set olApp = Nothing
    
    MsgBox "Meeting scheduling process completed.", vbInformation
End Sub